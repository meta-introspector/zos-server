[package]
name = "zos-server"
version = "0.1.0"
edition = "2021"
description = "Zero Ontology System - Complete plugin-based computation platform"
license = "MIT"
repository = "https://github.com/meta-introspector/zos-server"

[[bin]]
name = "zos_server"
path = "src/main.rs"

[dependencies]
# Optional core dependencies
serde = { version = "1.0", features = ["derive"], optional = true }
serde_json = { version = "1.0", optional = true }
uuid = { version = "1.0", features = ["v4"], optional = true }

# Optional heavy dependencies
tokio = { version = "1.0", features = ["rt", "macros"], optional = true }
libp2p = { version = "0.53", features = ["gossipsub", "mdns", "noise", "yamux", "tcp", "tokio"], optional = true }
libp2p-swarm-derive = { version = "0.34", optional = true }
reqwest = { version = "0.11", features = ["json"], optional = true }
axum = { version = "0.7", optional = true }
tower = { version = "0.4", optional = true }
tower-http = { version = "0.5", features = ["cors"], optional = true }
chrono = { version = "0.4", features = ["serde"], optional = true }

# Optional dynamic loading
libloading = { version = "0.8", optional = true }

[features]
default = ["core-only"]
slim = []
core-only = ["dep:serde", "dep:serde_json", "dep:uuid", "dep:tokio", "dep:libp2p", "dep:libp2p-swarm-derive", "dep:chrono"]
self-build = ["core-only", "reqwest"]
notebooklm = ["core-only"]
extra-plugins = ["core-only", "dep:axum", "dep:tower", "dep:tower-http"]
all-plugins = ["extra-plugins", "self-build", "notebooklm"]
dynamic-loading = ["dep:libloading"]

[profile.release]
opt-level = 3
lto = true
codegen-units = 1
panic = "abort"

[profile.dev]
opt-level = 0
debug = true
